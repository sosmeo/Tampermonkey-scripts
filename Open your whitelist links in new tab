// ==UserScript==
// @name         å¯¹ä½ æ·»åŠ çš„ç™½åå•ç½‘ç«™å¼ºåˆ¶æ–°æ ‡ç­¾é¡µæ‰“å¼€é“¾æ¥
// @namespace    http://tampermonkey.net/
// @author       sosmeo&chatgpt
// @version      2.0
// @description  ä»…è®©ç™½åå•ä¸­çš„ç½‘ç«™åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€é“¾æ¥ï¼Œå…¶ä»–ç½‘ç«™ä¸å—å½±å“
// @match        *://*/*
// @grant        none
// ==/UserScript==

(function() {
    'use strict';

    // ğŸ”¹ ä½ å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ /åˆ é™¤éœ€è¦ç”Ÿæ•ˆçš„ç½‘ç«™
    const whitelist = [
        'youtube.com',
        'example.com' // ä½ å¯ä»¥æ·»åŠ æ›´å¤šç½‘ç«™
    ];

    function isWhitelisted() {
        return whitelist.some(site => window.location.hostname.includes(site));
    }

    function openInNewTab(event) {
        if (!isWhitelisted()) return; // å¦‚æœå½“å‰ç½‘ç«™ä¸åœ¨ç™½åå•ï¼Œç›´æ¥é€€å‡º
        
        const link = event.target.closest('a'); // æ‰¾åˆ°ç‚¹å‡»çš„é“¾æ¥
        if (link && link.href && !link.hasAttribute('target') && link.href.startsWith('http')) {
            event.preventDefault(); // é˜»æ­¢é»˜è®¤è·³è½¬
            event.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡ï¼Œé˜²æ­¢å†…éƒ¨ JS è§¦å‘è·³è½¬
            setTimeout(() => {
                window.open(link.href, '_blank'); // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€é“¾æ¥
            }, 50); // å»¶è¿Ÿæ‰§è¡Œï¼Œæé«˜å…¼å®¹æ€§
        }
    }

    function observeLinks() {
        document.addEventListener('click', openInNewTab, true);
    }

    observeLinks(); // ç›‘å¬æ•´ä¸ªé¡µé¢ç‚¹å‡»äº‹ä»¶
})();
